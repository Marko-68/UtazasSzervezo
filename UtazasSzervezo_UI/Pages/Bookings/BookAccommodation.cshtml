@page "{accommodationId:int}"
@model UtazasSzervezo_UI.Pages.Bookings.BookAccommodationModel
@{
    ViewData["Title"] = "Book Accommodation";
}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

@if (Model.BookingSuccessful)
{
    <div class="modal fade show" id="bookingSuccessModal" tabindex="-1" aria-labelledby="bookingSuccessModalLabel" aria-hidden="true" style="display: block;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title" id="bookingSuccessModalLabel">Booking Successful!</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close" onclick="location.href='@Url.Page("/Booking/AccommodatonConfirmation")'"></button>
                </div>
                <div class="modal-body">
                    <p>Your accommodation has been booked successfully!</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="location.href='@Url.Page("/Booking/AccommodatonConfirmation")'">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-backdrop fade show"></div>
}
else
{
    <div class="container mt-5">
        <div class="row">
            <div class="col-md-8 offset-md-2">
                <div class="card shadow-sm mb-4">
                    <img src="~/@Model.Accommodation?.cover_img" class="card-img-top" alt="@Model.Accommodation?.name">
                    <div class="card-body">
                        <h5 class="card-title fw-bold">@Model.Accommodation?.name</h5>
                        <p class="card-text"><i class="bi bi-geo-alt-fill text-danger"></i> @Model.Accommodation?.city, @Model.Accommodation?.country</p>
                        <p class="card-text">Type: @Model.Accommodation?.type</p>
                        <p class="card-text">Guests: @Model.Accommodation?.guests</p>
                        <p class="card-text fw-bold">Price per night: $@Model.Accommodation?.price_per_night</p>
                        <hr class="my-3" />
                        <h6>Your Booking Details</h6>
                        <script>
                            document.querySelector('form').addEventListener('submit', () => {
                                console.log('Form submitting...');
                            });
                        </script>

                        <form method="post">
                            <div class="row mb-3">
                                <input asp-for="Booking.status" type="hidden" />
                                <input asp-for="Booking.user_id" type="hidden" />
                                <input asp-for="Booking.description" type="hidden" />
                                <div class="col-md-6">
                                    <label asp-for="Booking.start_date" class="form-label">Check-in Date</label>
                                    <input asp-for="Booking.start_date" class="form-control" type="date" value="@Model.Booking.start_date.ToString("yyyy-MM-dd")" required />
                                    <span asp-validation-for="Booking.start_date" class="text-danger"></span>
                                </div>
                                <div class="col-md-6">
                                    <label asp-for="Booking.end_date" class="form-label">Check-out Date</label>
                                    <input asp-for="Booking.end_date" class="form-control" type="date" value="@Model.Booking.end_date.ToString("yyyy-MM-dd")" required />
                                    <span asp-validation-for="Booking.end_date" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label asp-for="Booking.total_price" class="form-label">Total Price</label>
                                <input asp-for="Booking.total_price" class="form-control" type="number" step="0.01" value="@Model.Booking.total_price.ToString(System.Globalization.CultureInfo.InvariantCulture)" readonly />
                            </div>
                            <hr class="my-3" />
                            <h6>Your Personal Information</h6>
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label asp-for="FirstName" class="form-label">First Name</label>
                                    <input asp-for="FirstName" class="form-control" required />
                                    <span asp-validation-for="FirstName" class="text-danger"></span>
                                </div>
                                <div class="col-md-6">
                                    <label asp-for="LastName" class="form-label">Last Name</label>
                                    <input asp-for="LastName" class="form-control" required />
                                    <span asp-validation-for="LastName" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label asp-for="Email" class="form-label">Email Address</label>
                                <input asp-for="Email" type="email" class="form-control" required />
                                <span asp-validation-for="Email" class="text-danger"></span>
                            </div>
                            <div class="mb-3">
                                <label asp-for="PhoneNumber" class="form-label">Phone Number</label>
                                <input asp-for="PhoneNumber" class="form-control" required />
                                <span asp-validation-for="PhoneNumber" class="text-danger"></span>
                            </div>
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label asp-for="Country" class="form-label">Country</label>
                                    <input asp-for="Country" class="form-control" required />
                                    <span asp-validation-for="Country" class="text-danger"></span>
                                </div>
                                <div class="col-md-6">
                                    <label asp-for="PostalCode" class="form-label">Zip / Postal Code</label>
                                    <input asp-for="PostalCode" class="form-control" required />
                                    <span asp-validation-for="PostalCode" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label asp-for="Booking.special_request" class="form-label">Special Request</label>
                                <textarea asp-for="Booking.special_request" class="form-control" rows="3"></textarea>
                                <span asp-validation-for="Booking.special_request" class="text-danger"></span>
                            </div>
                            <div class="d-flex justify-content-between">
                                <a asp-page="/Accommodations/Details" asp-route-id="@Model.Accommodation?.id" class="btn btn-secondary">Cancel</a>
                                <button type="submit" class="btn btn-primary">Book Now</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
}